<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Diagnostics Hazelcast Documentation</title>
    <link rel="canonical" href="https://JakeSCahill.github.io/hazelcast/4.1/deploy/diagnostics.html">
    <meta name="generator" content="Antora 2.3.4">
    <link rel="stylesheet" href="../../../_/css/site.css">
<link rel="stylesheet" href="../../../_/css/search.css">
    <script async src="https://www.googletagmanager.com/gtag/js?id=GTM-M267KFN"></script>
    <script>function gtag(){dataLayer.push(arguments)};window.dataLayer=window.dataLayer||[];gtag('js',new Date());gtag('config','GTM-M267KFN')</script>
  </head>
  <body class="article">
<header class="header" role="banner">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://JakeSCahill.github.io">Hazelcast Documentation</a>
        <div class="navbar-item">
          <input id="search-input" type="text" placeholder="Search docs">
        </div>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Products</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Hazelcast IMDG</a>
            <a class="navbar-item" href="#">Hazelcast Jet</a>
            <a class="navbar-item" href="#">Hazelcast Cloud</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Use cases</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Service A</a>
            <a class="navbar-item" href="#">Service B</a>
            <a class="navbar-item" href="#">Service C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Resources</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Demos</a>
            <a class="navbar-item" href="#">GitHub</a>
            <a class="navbar-item" href="#">Community</a>
            <a class="navbar-item" href="#">Blog</a>
          </div>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="#">Download</a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="hazelcast" data-version="4.1">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../hazelcast_overview.html">Hazelcast IMDG</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../hazelcast_overview.html">Overview</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../get-started/getting_started.html">Get Started</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../get-started/glossary.html">Glossary</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../develop/hazelcast_clients.html">Develop Solutions</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../develop/jcache.html">JCache</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../develop/performance.html">Performance</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../develop/serialization.html">Serialization</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../develop/striim_cdc.html">Striim Hot Cache</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../develop/transactions.html">Transactions</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../develop/distributed_query.html">Distributed Query</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../develop/distributed_sql.html">Distributed SQL</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../develop/distributed_events.html">Distributed Events</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../develop/distributed_computing.html">Distributed Computing</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="installing_upgrading.html">Deploy Clusters</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="starting_members_clients.html">Starting Members and Clients</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="setting_up_clusters.html">Setting Up Clusters</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="management.html">Management</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="security.html">Security</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="simulator.html">Hazelcast Simulator</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="wan.html">WAN Replication</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="network_partitioning.html">Network Partitioning</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../migrate/migration_guides.html">Migrate</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../troubleshoot/common_exception_types.html">Troubleshooting</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../reference/faq.html">Reference</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../reference/dds.html">Distributed data structures</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../reference/system_properties.html">System properties</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../reference/understanding_configuration.html">Configuration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../reference/phone_homes.html">Phone homes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../reference/hazelcast_plugins.html">Plugins</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../contribute/extending_hazelcast.html">Contribute</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../contribute/licenses.html">Licenses</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../contribute/revision_history.html">Documentation changes</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Hazelcast IMDG</span>
    <span class="version">4.1</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">Hazelcast IMDG</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../hazelcast_overview.html">4.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Home</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../home/index.html">master</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../../home/index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../hazelcast_overview.html">Hazelcast IMDG</a></li>
    <li><a href="diagnostics.html">Diagnostics</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a class="git" href="file:///C:/Users/Jake%20Cahill/Documents/code-playground/docs/hazelcast-docs/modules/deploy/pages/diagnostics.adoc">Edit this Page</a></div>
</div>
  <div class="content">
<article class="doc">
<h1 class="page">Diagnostics</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Hazelcast offers an extended set of diagnostics plugins for both Hazelcast members and clients.
A dedicated log file is used to write the diagnostics content, and a rolling file approach is used to
prevent taking up too much disk space.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_enabling_diagnostics_logging"><a class="anchor" href="#_enabling_diagnostics_logging"></a>Enabling Diagnostics Logging</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To enable diagnostics logging, you should specify the following properties on the member side:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>-Dhazelcast.diagnostics.enabled=true
-Dhazelcast.diagnostics.metric.level=info
-Dhazelcast.diagnostics.invocation.sample.period.seconds=30
-Dhazelcast.diagnostics.pending.invocations.period.seconds=30
-Dhazelcast.diagnostics.slowoperations.period.seconds=30
-Dhazelcast.diagnostics.storeLatency.period.seconds=60</code></pre>
</div>
</div>
<div class="paragraph">
<p>On the client side, you should specify the following properties:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>-Dhazelcast.diagnostics.enabled=true
-Dhazelcast.diagnostics.metric.level=info</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_diagnostics_log_file"><a class="anchor" href="#_diagnostics_log_file"></a>Diagnostics Log File</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can use the following property to specify the location of the diagnostics log file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>-Dhazelcast.diagnostics.directory=/your/log/directory</code></pre>
</div>
</div>
<div class="paragraph">
<p>The name of the log file has the following format:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>diagnostics-&lt;host IP&gt;#&lt;port&gt;-&lt;unique ID&gt;.log</code></pre>
</div>
</div>
<div class="paragraph">
<p>The name of the log file can be prefixed with a custom string as shown below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>-Dhazelcast.diagnostics.filename.prefix=foobar</code></pre>
</div>
</div>
<div class="paragraph">
<p>The content format of the diagnostics log file is depicted below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>&lt;Date&gt; BuildInfo[
	&lt;log content for BuildInfo diagnostics plugin&gt;]
&lt;Date&gt; SystemProperties[
	&lt;log content for SystemProperties diagnostics plugin&gt;]
&lt;Date&gt; ConfigProperties[
	&lt;log content for ConfigProperties diagnostics plugin&gt;]
&lt;Date&gt; Metrics[
	&lt;log content for Metrics diagnostics plugin&gt;]
&lt;Date&gt; SlowOperations[
	&lt;log content for SlowOperations diagnostics plugin&gt;]
&lt;Date&gt; HazelcastInstance[
	&lt;log content for HazelcastInstance diagnostics plugin&gt;]
...
...
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>A rolling file approach is used to prevent creating too much data. By default 10 files of 50MB each are allowed
to exist. The size of the file can be changed using the following property:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>-Dhazelcast.diagnostics.max.rolled.file.size.mb=100</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also set the number of files using the following property:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>-Dhazelcast.diagnostics.max.rolled.file.count=5</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_diagnostics_plugins"><a class="anchor" href="#_diagnostics_plugins"></a>Diagnostics Plugins</h2>
<div class="sectionbody">
<div class="paragraph">
<p>As it is stated in the introduction of this section and shown in the log file content above,
diagnostics utility consists of plugins such as BuildInfo, SystemProperties and HazelcastInstance.</p>
</div>
<div class="sect2">
<h3 id="_buildinfo"><a class="anchor" href="#_buildinfo"></a>BuildInfo</h3>
<div class="paragraph">
<p>It shows the detailed Hazelcast build information including the Hazelcast release number,
<code>Git</code> revision number and whether you have Hazelcast IMDG Enterprise or not.</p>
</div>
</div>
<div class="sect2">
<h3 id="_systemproperties"><a class="anchor" href="#_systemproperties"></a>SystemProperties</h3>
<div class="paragraph">
<p>It shows all the properties and their values in your system used by and configured for
your Hazelcast installation. These are the properties starting with <code>java</code> (excluding <code>java.awt</code>),
<code>hazelcast</code>, <code>sun</code> and <code>os</code>. It also includes the arguments that are used to startup the JVM.</p>
</div>
</div>
<div class="sect2">
<h3 id="_configproperties"><a class="anchor" href="#_configproperties"></a>ConfigProperties</h3>
<div class="paragraph">
<p>It shows the Hazelcast properties and their values explicitly set by you either
on the command line (with <code>-D</code>) or by using declarative/programmatic configuration.</p>
</div>
</div>
<div class="sect2">
<h3 id="diagnostics-metrics"><a class="anchor" href="#diagnostics-metrics"></a>Metrics</h3>
<div class="paragraph">
<p>It shows a comprehensive log of what is happening in your Hazelcast system.</p>
</div>
<div class="paragraph">
<p>You can configure the frequency of dumping information to the log file using the following property:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>hazelcast.diagnostics.metrics.period.seconds</code>: Set a value in seconds.
Its default value is <code>60</code> seconds.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_slowoperations"><a class="anchor" href="#_slowoperations"></a>SlowOperations</h3>
<div class="paragraph">
<p>It shows the slow operations and invocations, See the <a href="#slowoperationdetector">SlowOperationDetector section</a>
for more information.</p>
</div>
</div>
<div class="sect2">
<h3 id="_invocations"><a class="anchor" href="#_invocations"></a>Invocations</h3>
<div class="paragraph">
<p>It shows all kinds of statistics about current and past invocations including
current pending invocations, history of invocations and
slow history, i.e., all samples where the invocation took more than the defined threshold.
Slow history does not only include the invocations where the operations took a lot of time,
but it also includes any other invocations that have been obstructed.</p>
</div>
<div class="paragraph">
<p>Using the following properties, you can configure the frequency of scanning all
pending invocations and the threshold that makes an invocation to be considered as slow:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>hazelcast.diagnostics.invocation.sample.period.seconds</code>: Set a value in seconds.
Its default value is <code>60</code> seconds.</p>
</li>
<li>
<p><code>hazelcast.diagnostics.invocation.slow.threshold.seconds</code>: Set a value in seconds.
Its default value is <code>5</code> seconds.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_hazelcastinstance"><a class="anchor" href="#_hazelcastinstance"></a>HazelcastInstance</h3>
<div class="paragraph">
<p>It shows the basic state of your Hazelcast cluster including the count and
addresses of current members and the address of oldest cluster member.
It is useful to get a fast impression of the cluster without needing to analyze a lot of data.</p>
</div>
<div class="paragraph">
<p>You can configure the frequency at which the cluster information is dumped to the log file using the following property:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>hazelcast.diagnostics.memberinfo.period.second</code>: Set a value in seconds. Its default value is <code>60</code> seconds.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_eventqueue"><a class="anchor" href="#_eventqueue"></a>EventQueue</h3>
<div class="paragraph">
<p>It checks the event queues in the data structures and samples the event types if the queue size is
above a certain threshold. It is useful to figure out why the event
queue is running full.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>hazelcast.diagnostics.event.queue.period.seconds</code>: Duration, in seconds, that this plugin runs,
gathers information and writes to the diagnostics log file.
When set to <code>0</code> (its default value), it is disabled.</p>
</li>
<li>
<p><code>hazelcast.diagnostics.event.queue.threshold</code>: Minimum number of events in the
queue before it is being sampled. Its default value is <code>1000</code>.</p>
</li>
<li>
<p><code>hazelcast.diagnostics.event.queue.samples</code>: Number of samples to take from the event queue.
Increasing the number of samples gives more accuracy of the content, but it has a negative
performance effect. Its default value is <code>100</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>An example output for a Hazelcast map is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>17-04-2019 17:36:37 EventQueues[
    worker=1[
        eventCount=441
        sampleCount=100
        samples[
            IMap 'myMap' ADDED sampleCount=51 51.000%
            IMap 'myMap' REMOVED sampleCount=49 49.000%]]</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_systemlog"><a class="anchor" href="#_systemlog"></a>SystemLog</h3>
<div class="paragraph">
<p>It shows the activities in your cluster including when a connection/member is added or removed and
if there is a change in the lifecycle of the cluster.
It also includes the reasons for connection closings.</p>
</div>
<div class="paragraph">
<p>You can enable or disable the system log diagnostics plugin, and configure whether
it shows information about partition migrations using the following properties:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>hazelcast.diagnostics.systemlog.enabled</code>: Its default value is <code>true</code>.</p>
</li>
<li>
<p><code>hazelcast.diagnostics.systemlog.partitions</code>: Its default value is <code>false</code>.
Please note that if you enable this, you may get a lot of log entries if you have many partitions.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_storelatency"><a class="anchor" href="#_storelatency"></a>StoreLatency</h3>
<div class="paragraph">
<p>It shows statistics including the count of methods for each store (<code>load</code>, <code>loadAll</code>,
<code>loadAllKeys</code>, etc.), average and maximum latencies for each store method calls and
latency distributions for each store. The following is an example output snippet as part of
the diagnostics log file for Hazelcast MapStore:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>17-9-2019 13:12:34 MapStoreLatency[
    map[
        loadAllKeys[
            count=1
            totalTime(us)=8
            avg(us)=8
            max(us)=8
            latency-distribution[
                0..99us=1]]
        load[
            count=100
            totalTime(us)=4,632,190
            avg(us)=46,321
            max(us)=99,178
            latency-distribution[
                0..99us=1
                1600..3199us=3
                3200..6399us=3
                6400..12799us=7
                12800..25599us=13
                25600..51199us=32
                51200..102399us=41]]]]</code></pre>
</div>
</div>
<div class="paragraph">
<p>According to your store usage, a similar output can be seen for Hazelcast JCache,
Queue and Ringbuffer with persistent datastores.</p>
</div>
<div class="paragraph">
<p>You can control the StoreLatency plugin using the following properties:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>hazelcast.diagnostics.storeLatency.period.seconds</code>: The frequency this plugin is writing
the collected information to the disk. By default it is disabled.
A sensible production value would be <code>60</code> seconds.</p>
</li>
<li>
<p><code>hazelcast.diagnostics.storeLatency.reset.period.seconds</code>: The period of resetting the statistics.
If, for example, it is set as 300 (5 minutes), all the statistics are cleared for every 5 minutes.
By default it is 0, meaning that statistics are not reset.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_operationheartbeats"><a class="anchor" href="#_operationheartbeats"></a>OperationHeartbeats</h3>
<div class="paragraph">
<p>It shows the deviation between member/member operation heartbeats.
Each member, regardless if there is an operation running on behalf of that member,
sends an operation heartbeat to every other member. It contains a listing of all <code>callId</code>s of the running
operations from a given member.
This plugin also works fine between members/lite-members.</p>
</div>
<div class="paragraph">
<p>Because this operation heartbeat is sent periodically;
by default 1/4 of the operation call timeout of 60 seconds, we would expect
an operation heartbeat to be received every 15 seconds.
Operation heartbeats are high priority packets (so they overtake regular packets)
and are processed by an isolated thread in the invocation monitor.
If there is any deviation in the frequency of receiving
these packets, it may be due to the problems such as network latencies.</p>
</div>
<div class="paragraph">
<p>The following shows an example of the output where an operation heartbeat has not been received for 37 seconds:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>20-7-2019 11:12:55 OperationHeartbeats[
    member[10.212.1.119]:5701[
        deviation(%)=146.6666717529297
        noHeartbeat(ms)=37,000
        lastHeartbeat(ms)=1,500,538,375,603
        lastHeartbeat(date-time)=20-7-2017 11:12:55
        now(ms)=1,500,538,338,603
        now(date-time)=20-7-2017 11:12:18]]]</code></pre>
</div>
</div>
<div class="paragraph">
<p>The OperationHeartbeats plugin is enabled by default since it has very little overhead and only prints to the diagnostics
file if the maximum deviation percentage (explained below) is exceeded.</p>
</div>
<div class="paragraph">
<p>You can control the OperationHeartbeats plugin using the following properties:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>hazelcast.diagnostics.operation-heartbeat.seconds</code>:
The frequency this plugin is writing the collected information to the disk.
It is configured to be 10 seconds by default. 0 disables the plugin.</p>
</li>
<li>
<p><code>hazelcast.diagnostics.operation-heartbeat.max-deviation-percentage</code>:
The maximum allowed deviation percentage. Its default value is 33.
For example, with a default 60 call timeout and operation heartbeat interval being 15 seconds,
the maximum deviation with a deviation-percentage of 33, is 5 seconds.
So there is no problem if a packet is arrived after 19 seconds, but if it arrives after 21 seconds,
then the plugin renders.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_memberheartbeats"><a class="anchor" href="#_memberheartbeats"></a>MemberHeartbeats</h3>
<div class="paragraph">
<p>This plugin looks a lot like the OperationHeartbeats plugin, but instead of
relying on operation heartbeats to determine the deviation, it relies on member/member cluster heartbeats.
Every member sends a heartbeat to other members periodically (by default every 5 seconds).</p>
</div>
<div class="paragraph">
<p>Just like the OperationHeartbeats, the MemberHeartbeats plugin can be used to
detect if there are networking problems long before they actually lead to problems such as split-brain syndromes.</p>
</div>
<div class="paragraph">
<p>The following shows an example of the output where no member/member heartbeat has been received for 9 seconds:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>20-7-2019 19:32:22 MemberHeartbeats[
    member[10.212.1.119]:5701[
        deviation(%)=80.0
        noHeartbeat(ms)=9,000
        lastHeartbeat(ms)=1,500,568,333,645
        lastHeartbeat(date-time)=20-7-2017 19:32:13
        now(ms)=1,500,568,342,645
        now(date-time)=20-7-2017 19:32:22]]</code></pre>
</div>
</div>
<div class="paragraph">
<p>The MemberHeartbeats plugin is enabled by default since it has very little overhead and only prints to the diagnostics
file if the maximum deviation percentage (explained below) is exceeded.</p>
</div>
<div class="paragraph">
<p>You can control the MemberHeartbeats plugin using the following properties:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>hazelcast.diagnostics.member-heartbeat.seconds</code>:
The frequency this plugin is writing the collected information to the disk.
It is configured to be 10 seconds by default. 0 disables the plugin.</p>
</li>
<li>
<p><code>hazelcast.diagnostics.member-heartbeat.max-deviation-percentage</code>:
The maximum allowed deviation percentage. Its default value is 100.
For example, if the interval of member/member heartbeats is 5 seconds, a 100% deviation is fine with
heartbeats arriving up to 5 seconds after they are expected.
So a heartbeat arriving after 9 seconds is not rendered, but a heartbeat received after 11 seconds is rendered.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_operationthreadsamples"><a class="anchor" href="#_operationthreadsamples"></a>OperationThreadSamples</h3>
<div class="paragraph">
<p>This plugin samples the operation threads and checks the running operations/tasks.
Hazelcast has the <a href="#slowoperationdetector">slow operation detector</a> which is useful for
very slow operations. But it may not be efficient for high volumes of not too slow operations.
Using the OperationThreadSamples plugin it is more clear to see which operations are actually running.</p>
</div>
<div class="paragraph">
<p>You can control the OperationThreadSamples plugin using the following properties:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>hazelcast.diagnostics.operationthreadsamples.period.seconds</code>:
The frequency this plugin is writing the collected information to the disk.
An efficient value for production would be 30, 60 or more seconds. 0, which is the default value, disables the plugin.</p>
</li>
<li>
<p><code>hazelcast.diagnostics.operationthreadsamples.sampler.period.millis</code>:
The period in milliseconds between taking samples.
The lower the value, the higher the overhead but also the higher the precision.
Its default value is 100 ms.</p>
</li>
<li>
<p><code>hazelcast.diagnostics.operationthreadsamples.includeName</code>:
Specifies whether the data structures' name pointed to by the operation (if available) should be
included in the name of the samples. Its default value is false.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following shows an example of the output when the property
<code>hazelcast.diagnostics.operationthreadsamples.includeName</code> is false:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-plain hljs" data-lang="plain">28-08-2019 07:40:07 1535442007330 OperationThreadSamples[
    Partition[
        com.hazelcast.map.impl.operation.MapSizeOperation=304623 85.6927%
        com.hazelcast.map.impl.operation.PutOperation=33061 9.300304%
        com.hazelcast.map.impl.operation.GetOperation=17799 5.0069904%]
    Generic[
        com.hazelcast.client.impl.ClientEngineImpl$PriorityPartitionSpecificRunnable=2308 35.738617%
        com.hazelcast.nio.Packet=1767 27.361412%
        com.hazelcast.internal.cluster.impl.operations.JoinRequestOp=821 12.712914%
        com.hazelcast.spi.impl.operationservice.impl.operations.PartitionIteratingOperation=278 4.3047385%
        com.hazelcast.internal.cluster.impl.operations.HeartbeatOp=93 1.4400743%
        com.hazelcast.internal.cluster.impl.operations.OnJoinOp=89 1.3781357%
        com.hazelcast.internal.cluster.impl.operations.WhoisMasterOp=75 1.1613503%
        com.hazelcast.client.impl.operations.ClientReAuthOperation=33 0.51099414%]]</code></pre>
</div>
</div>
<div class="paragraph">
<p>As can be seen above, the <code>MapSizeOperations</code> run on the operation threads most of the time.</p>
</div>
</div>
<div class="sect2">
<h3 id="_wandiagnostics"><a class="anchor" href="#_wandiagnostics"></a>WanDiagnostics</h3>
<div class="paragraph">
<p>The WAN diagnostics plugin provides information about the WAN replication.</p>
</div>
<div class="paragraph">
<p>It is disabled by default and can be configured using the following property:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>hazelcast.diagnostics.wan.period.seconds</code>:
The frequency this plugin is writing the collected information to the disk. 0 disables the plugin.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following shows an example of the output:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>10-11-2019 14:11:32 1510319492497 WanBatchSenderLatency[
    targetClusterName[
        [127.0.0.1]:5801[
            count=1
            totalTime(us)=2,010,567
            avg(us)=2,010,567
            max(us)=2,010,567
            latency-distribution[
                1638400..3276799us=1]]
         [127.0.0.1]:5802[
             count=1
             totalTime(us)=1,021,867
             avg(us)=1,021,867
             max(us)=1,021,867
             latency-distribution[
                 819200..1638399us=1]]]]</code></pre>
</div>
</div>
</div>
</div>
</div>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script src="../../../_/js/site.js"></script>
<link rel="shortcut icon" href="http://hazelcast.com/images/favicon.png">
<script src="../../../_/js/vendor/lunr.js"></script>
<script src="../../../_/js/vendor/search.js" id="search-script" data-base-path="../../.." data-page-path="/hazelcast/4.1/deploy/diagnostics.html"></script>
<script async src="../../../_/../search-index.js"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
